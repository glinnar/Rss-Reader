<?php include "classUrl.php";?>
<?php include "newXmlstream.php";?>


<form class="" action="test.php" method="post">
  <select class="" name="Rss-feed">
      <option value="1">Google</option>
      <option value="2">Aftonbladet</option>
    </select>
    <select class="" name="View_format">
      <option value="html_format">Html</option>
      <option value="plain_text">Text</option>
    </select>
    <select class="" name="Sort_by">
      <option value="pubdDate">Publication Date</option>
      <option value="title">Title</option>
    </select>
    <input type="submit"id="showfeed" name="showfeed" value="Show Feed">
  </select>
</form>

<?php
if(isset($_POST['showfeed'])){
  $Option = $_POST['Rss-feed'];
  $Sort = $_POST['Sort_by'];

  if($Option =="1"){
$url=("http://feeds.bbci.co.uk/news/rss.xml") or die("Cannot load Rss feed");
$xml= simplexml_load_file($url);
$items=array();
foreach ($xml->channel->item as $read) {
  $items[] = $read;
  # code...
}
if($Sort=="pubDate"){
// Sortera på publiceringsDatum
usort($items,function($a,$b){
  return strtotime(str_replace('/', '-', $a->pubDate)) - strtotime(str_replace('/', '-', $b->pubDate));
});
}

elseif ($Sort=="title") {
  usort($items,function($c,$d){
    return strcasecmp($c->title,$d->title);
  });
}

foreach($items as $item){
  $title=$item->title;
  $link =$item->link;
  $guid=$item->guid;
  $category=$item->category;
  $pubDate=$item->pubDate;
  $media=$item->media;
  $description=$item->description;

$html= $title. $link.$guid.$category.$pubDate.$media.$description;
echo "<h1>".$html,"</h1>","</br>";
}
}
else if($Option =="2") {
  $url2 =("http://www.aftonbladet.se/sportbladet/rss.xml");
  $xml2=simplexml_load_file($url2);
  $items=array();
  foreach ($xml2->channel->item as $read) {
    $items[] = $read;
    # code...
  }
  if($Sort=="pubDate"){
  // Sortera på publiceringsDatum
  usort($items,function($a,$b){
    return strtotime(str_replace('/', '-', $a->pubDate)) - strtotime(str_replace('/', '-', $b->pubDate));
  });
  }

  elseif ($Sort=="title") {
    usort($items,function($c,$d){
      return strcasecmp($c->title,$d->title);
    });
  }

  foreach($xml2->channel->item as $read2){
    $link2 =$read2->link;
    $guid2=$read2->guid;
    $category2=$read2->category2;
    $title2=$read2->title;
    $pubDate2=$read2->pubDate;
    $description2=$read2->description;

  $html2= $title2. $link2.$guid2.$pubDate2.$description2;
    echo "<p>".$html2,"</br>","</p>","</br>";
  }
}
}

?>
